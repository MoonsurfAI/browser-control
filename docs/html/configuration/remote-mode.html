<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Remote Mode - Moonsurf Documentation</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poltawski+Nowy:wght@400;500;600;700&display=block" as="style">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=block" as="style">
  <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
  <nav class="sidebar">
  <div class="sidebar-header">
    <a href="../index.html" class="logo">Moonsurf</a>
  </div>
  <ul class="nav-list">
    <li><a href="../index.html">Moonsurf Browser Control Documentation</a></li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="rocket"></i>Getting Started</span>
      <ul class="section-items">
        <li><a href="../getting-started/README.html">Overview</a></li>
        <li><a href="../getting-started/connecting-ai-clients.html">Connecting AI Clients</a></li>
        <li><a href="../getting-started/first-automation.html">First Automation</a></li>
        <li><a href="../getting-started/installation.html">Installation</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="lightbulb"></i>Concepts</span>
      <ul class="section-items">
        <li><a href="../concepts/README.html">Overview</a></li>
        <li><a href="../concepts/architecture.html">Architecture</a></li>
        <li><a href="../concepts/browser-modes.html">Browser Modes</a></li>
        <li><a href="../concepts/extension-communication.html">Extension Communication</a></li>
        <li><a href="../concepts/instance-lifecycle.html">Instance Lifecycle</a></li>
        <li><a href="../concepts/mcp-protocol.html">MCP Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="wrench"></i>Tools</span>
      <ul class="section-items">
        <li><a href="../tools/README.html">Overview</a></li>
        <li><a href="../tools/browser-content.html">browser_content</a></li>
        <li><a href="../tools/browser-debug.html">browser_debug</a></li>
        <li><a href="../tools/browser-emulate.html">browser_emulate</a></li>
        <li><a href="../tools/browser-execute.html">browser_execute</a></li>
        <li><a href="../tools/browser-instance.html">browser_instance</a></li>
        <li><a href="../tools/browser-interact.html">browser_interact</a></li>
        <li><a href="../tools/browser-navigate.html">browser_navigate</a></li>
        <li><a href="../tools/browser-network.html">browser_network</a></li>
        <li><a href="../tools/browser-tab.html">browser_tab</a></li>
      </ul>
    </li>
    <li class="nav-section open">
      <span class="section-title"><i data-lucide="settings"></i>Configuration</span>
      <ul class="section-items">
        <li><a href="../configuration/README.html">Overview</a></li>
        <li><a href="../configuration/authentication.html">Authentication</a></li>
        <li><a href="../configuration/environment-variables.html">Environment Variables</a></li>
        <li><a href="../configuration/local-mode.html">Local Mode</a></li>
        <li><a href="../configuration/remote-mode.html" class="active">Remote Mode</a></li>
        <li><a href="../configuration/security-hardening.html">Security Hardening</a></li>
        <li><a href="../configuration/tls-setup.html">TLS Setup</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="book-open"></i>Guides</span>
      <ul class="section-items">
        <li><a href="../guides/README.html">Overview</a></li>
        <li><a href="../guides/debugging-tips.html">Debugging Tips Guide</a></li>
        <li><a href="../guides/file-downloads.html">File Downloads Guide</a></li>
        <li><a href="../guides/form-filling.html">Form Filling Guide</a></li>
        <li><a href="../guides/handling-popups.html">Handling Popups Guide</a></li>
        <li><a href="../guides/network-interception.html">Network Interception Guide</a></li>
        <li><a href="../guides/testing-workflows.html">Testing Workflows Guide</a></li>
        <li><a href="../guides/web-scraping.html">Web Scraping Guide</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="plug"></i>Integration</span>
      <ul class="section-items">
        <li><a href="../integration/README.html">Overview</a></li>
        <li><a href="../integration/ci-cd.html">CI/CD Integration</a></li>
        <li><a href="../integration/claude-code.html">Claude Code Integration</a></li>
        <li><a href="../integration/claude-desktop.html">Claude Desktop Integration</a></li>
        <li><a href="../integration/cursor.html">Cursor Integration</a></li>
        <li><a href="../integration/custom-clients.html">Custom Client Integration</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="code"></i>Api Reference</span>
      <ul class="section-items">
        <li><a href="../api-reference/README.html">Overview</a></li>
        <li><a href="../api-reference/error-codes.html">Error Codes</a></li>
        <li><a href="../api-reference/http-endpoints.html">HTTP Endpoints</a></li>
        <li><a href="../api-reference/sse-protocol.html">SSE Protocol</a></li>
        <li><a href="../api-reference/websocket-protocol.html">WebSocket Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="list-checks"></i>Tasks</span>
      <ul class="section-items">
        <li><a href="../tasks/README.html">Overview</a></li>
        <li><a href="../tasks/architecture.html">Architecture Overview</a></li>
        <li><a href="../tasks/configuration.html">Configuration</a></li>
        <li><a href="../tasks/contributing.html">Contributing</a></li>
        <li><a href="../tasks/error-handling.html">Error Handling</a></li>
        <li><a href="../tasks/examples.html">Examples</a></li>
        <li><a href="../tasks/getting-started.html">Getting Started</a></li>
        <li><a href="../tasks/internals.html">Internals</a></li>
        <li><a href="../tasks/rest-api.html">REST API Reference</a></li>
        <li><a href="../tasks/task-format.html">Task Format</a></li>
        <li><a href="../tasks/websocket-api.html">WebSocket API Reference</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="terminal"></i>Development</span>
      <ul class="section-items">
        <li><a href="../development/README.html">Overview</a></li>
        <li><a href="../development/adding-tools.html">Adding Tools</a></li>
        <li><a href="../development/debugging.html">Debugging</a></li>
        <li><a href="../development/extension-development.html">Extension Development</a></li>
        <li><a href="../development/internals.html">Internals</a></li>
        <li><a href="../development/local-setup.html">Local Development Setup</a></li>
        <li><a href="../development/project-structure.html">Project Structure</a></li>
        <li><a href="../development/release-process.html">Release Process</a></li>
        <li><a href="../development/testing.html">Testing</a></li>
      </ul>
    </li>
  </ul>
  <div class="sidebar-footer">
    <div class="version">v2.0.0</div>
    <div class="generated">Generated 2026-01-26</div>
  </div>
</nav>

  <main class="content">
    <article>
      <h1>Remote Mode</h1>
<p>Remote mode enables Moonsurf to accept connections from external clients. This is used for production deployments where AI clients connect over the network.</p>
<h2>Enabling Remote Mode</h2>
<pre><code class="language-bash">REMOTE_MODE=true moonsurf</code></pre><p>This changes default settings to be more secure:</p>
<div class="table-wrapper"><table><thead><tr><th>Setting</th><th>Local Default</th><th>Remote Default</th></tr></thead><tbody><tr><td><code>HOST</code></td><td><code>localhost</code></td><td><code>0.0.0.0</code></td></tr><tr><td><code>AUTH_ENABLED</code></td><td><code>false</code></td><td><code>true</code></td></tr><tr><td><code>CORS_ENABLED</code></td><td><code>false</code></td><td><code>true</code></td></tr><tr><td><code>RATE_LIMIT_ENABLED</code></td><td><code>false</code></td><td><code>true</code></td></tr><tr><td><code>AUDIT_LOG_ENABLED</code></td><td><code>false</code></td><td><code>true</code></td></tr><tr><td><code>HEADLESS_DEFAULT</code></td><td><code>false</code></td><td><code>true</code></td></tr></tbody></table></div><h2>Minimum Remote Configuration</h2>
<p>You must provide authentication tokens:</p>
<pre><code class="language-bash">REMOTE_MODE=true AUTH_TOKENS=your-secret-token moonsurf</code></pre><p>Without tokens, the server will error on startup.</p>
<h2>Recommended Production Configuration</h2>
<pre><code class="language-bash">REMOTE_MODE=true \
AUTH_TOKENS=token-for-claude,token-for-cursor \
TLS_ENABLED=true \
TLS_CERT_PATH=/path/to/cert.pem \
TLS_KEY_PATH=/path/to/key.pem \
CORS_ORIGINS=https://your-app.com \
RATE_LIMIT_MAX_CALLS=50 \
moonsurf</code></pre><h2>Public URL</h2>
<p>When behind a proxy or load balancer, set the public URL:</p>
<pre><code class="language-bash">REMOTE_MODE=true \
PUBLIC_URL=https://mcp.example.com \
AUTH_TOKENS=secret-token \
moonsurf</code></pre><p>The public URL is used for:</p>
<ul>
<li>SSE endpoint announcements</li>
<li>Client configuration</li>
<li>OAuth endpoints</li>
</ul>
<h2>Architecture Considerations</h2>
<h3>WebSocket Locality</h3>
<p>Browser extension WebSockets always connect to <code>localhost</code>:</p>
<pre><code class="language-plaintext">┌──────────────────────────────────────────────────────┐
│                     Server Host                       │
│                                                       │
│   ┌─────────────────┐    ┌────────────────────────┐  │
│   │   MCP Server    │    │     Browser Process    │  │
│   │                 │    │                        │  │
│   │  HTTP :3300     │◄───│     Extension ─────────│  │
│   │  (0.0.0.0)      │    │    ws://localhost:3301 │  │
│   │                 │    │                        │  │
│   └────────┬────────┘    └────────────────────────┘  │
│            │                                          │
└────────────┼──────────────────────────────────────────┘
             │ External Network
             │
        AI Client (Remote)</code></pre><p>This means:</p>
<ul>
<li>Browsers must run on the same host as the MCP server</li>
<li>AI clients can connect remotely</li>
<li>WebSocket ports (3301-3399) don&#39;t need external exposure</li>
</ul>
<h3>Firewall Configuration</h3>
<p>Only the HTTP port needs to be accessible:</p>
<pre><code class="language-bash"># Allow HTTP/HTTPS port
ufw allow 3300/tcp

# WebSocket ports stay local - no firewall rule needed</code></pre><h2>Using a Reverse Proxy</h2>
<h3>Nginx Configuration</h3>
<pre><code class="language-nginx">upstream moonsurf {
    server 127.0.0.1:3300;
}

server {
    listen 443 ssl http2;
    server_name mcp.example.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://moonsurf;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &quot;upgrade&quot;;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # SSE specific settings
        proxy_buffering off;
        proxy_cache off;
        proxy_read_timeout 86400s;
    }
}</code></pre><p>Then run Moonsurf without TLS (proxy handles it):</p>
<pre><code class="language-bash">REMOTE_MODE=true \
PUBLIC_URL=https://mcp.example.com \
AUTH_TOKENS=secret-token \
TLS_ENABLED=false \
moonsurf</code></pre><h3>Caddy Configuration</h3>
<pre><code class="language-plaintext">mcp.example.com {
    reverse_proxy localhost:3300
}</code></pre><p>Caddy automatically handles TLS.</p>
<h2>Docker Deployment</h2>
<pre><code class="language-dockerfile">FROM node:20-slim

# Install Chromium
RUN apt-get update &amp;&amp; apt-get install -y \
    chromium \
    --no-install-recommends \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Install Moonsurf
RUN npm install -g @moonsurf/browser-control

# Configure
ENV PORT=3300
ENV HOST=0.0.0.0
ENV REMOTE_MODE=true
ENV BROWSER_DEFAULT_MODE=chromium
ENV HEADLESS_DEFAULT=true

EXPOSE 3300

CMD [&quot;moonsurf&quot;]</code></pre><p>Run with:</p>
<pre><code class="language-bash">docker run -p 3300:3300 -e AUTH_TOKENS=your-token moonsurf</code></pre><h2>Client Configuration</h2>
<h3>Claude Code</h3>
<pre><code class="language-json">{
  &quot;mcpServers&quot;: {
    &quot;moonsurf&quot;: {
      &quot;url&quot;: &quot;https://mcp.example.com/sse?token=your-token&quot;
    }
  }
}</code></pre><h3>Custom Client</h3>
<pre><code class="language-javascript">const eventSource = new EventSource(
  &#039;https://mcp.example.com/sse?token=your-token&#039;
);</code></pre><h2>Monitoring</h2>
<h3>Health Check</h3>
<pre><code class="language-bash">curl https://mcp.example.com/health</code></pre><p>Response:</p>
<pre><code class="language-json">{
  &quot;status&quot;: &quot;ok&quot;,
  &quot;version&quot;: &quot;2.0.0&quot;,
  &quot;connectedInstances&quot;: 2,
  &quot;sseClients&quot;: 5,
  &quot;auth&quot;: &quot;enabled&quot;,
  &quot;tls&quot;: &quot;enabled&quot;,
  &quot;rateLimit&quot;: &quot;enabled&quot;
}</code></pre><h3>Audit Logs</h3>
<p>With <code>AUDIT_LOG_ENABLED=true</code>, security events are logged:</p>
<pre><code class="language-plaintext">[AUDIT] {&quot;timestamp&quot;:&quot;2024-01-15T10:30:00Z&quot;,&quot;action&quot;:&quot;SSE_CONNECTED&quot;,&quot;sessionId&quot;:&quot;abc...&quot;,&quot;ip&quot;:&quot;1.2.3.4&quot;}
[AUDIT] {&quot;timestamp&quot;:&quot;2024-01-15T10:30:01Z&quot;,&quot;action&quot;:&quot;MCP_REQUEST&quot;,&quot;method&quot;:&quot;tools/call&quot;,&quot;ip&quot;:&quot;1.2.3.4&quot;}
[AUDIT] {&quot;timestamp&quot;:&quot;2024-01-15T10:30:05Z&quot;,&quot;action&quot;:&quot;AUTH_FAILED&quot;,&quot;ip&quot;:&quot;5.6.7.8&quot;}</code></pre><h2>Security Checklist</h2>
<ul>
<li><input disabled="" type="checkbox"> Authentication enabled (<code>AUTH_ENABLED=true</code>)</li>
<li><input disabled="" type="checkbox"> Strong tokens configured (<code>AUTH_TOKENS</code>)</li>
<li><input disabled="" type="checkbox"> TLS enabled (direct or via proxy)</li>
<li><input disabled="" type="checkbox"> Rate limiting configured</li>
<li><input disabled="" type="checkbox"> CORS origins restricted</li>
<li><input disabled="" type="checkbox"> Audit logging enabled</li>
<li><input disabled="" type="checkbox"> Firewall configured (only HTTP port exposed)</li>
<li><input disabled="" type="checkbox"> Regular token rotation planned</li>
</ul>
<h2>Troubleshooting</h2>
<h3>&quot;Authentication enabled but no tokens configured&quot;</h3>
<p>You must provide tokens in remote mode:</p>
<pre><code class="language-bash">AUTH_TOKENS=secret-token moonsurf</code></pre><h3>&quot;Connection refused from remote client&quot;</h3>
<p>Check:</p>
<ol>
<li>HOST is <code>0.0.0.0</code> or the correct interface</li>
<li>Firewall allows the port</li>
<li>Client is using correct URL</li>
</ol>
<h3>&quot;SSE connection drops&quot;</h3>
<p>For long-lived SSE connections behind a proxy:</p>
<ul>
<li>Increase proxy timeouts</li>
<li>Disable proxy buffering</li>
<li>Check keep-alive settings</li>
</ul>
<h2>Related</h2>
<ul>
<li><a href="environment-variables.html">Environment Variables</a> - All configuration options</li>
<li><a href="authentication.html">Authentication</a> - Token configuration</li>
<li><a href="tls-setup.html">TLS Setup</a> - HTTPS configuration</li>
<li><a href="security-hardening.html">Security Hardening</a> - Additional security measures</li>
</ul>

    </article>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Initialize syntax highlighting
    hljs.highlightAll();

    // Toggle sections
    document.querySelectorAll('.section-title').forEach(title => {
      title.addEventListener('click', () => {
        title.parentElement.classList.toggle('open');
      });
    });
  </script>
</body>
</html>