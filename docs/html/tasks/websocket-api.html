<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebSocket API Reference - Moonsurf Documentation</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poltawski+Nowy:wght@400;500;600;700&display=block" as="style">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=block" as="style">
  <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
  <nav class="sidebar">
  <div class="sidebar-header">
    <a href="../index.html" class="logo">Moonsurf</a>
  </div>
  <ul class="nav-list">
    <li><a href="../index.html">Moonsurf Browser Control Documentation</a></li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="rocket"></i>Getting Started</span>
      <ul class="section-items">
        <li><a href="../getting-started/README.html">Overview</a></li>
        <li><a href="../getting-started/connecting-ai-clients.html">Connecting AI Clients</a></li>
        <li><a href="../getting-started/first-automation.html">First Automation</a></li>
        <li><a href="../getting-started/installation.html">Installation</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="lightbulb"></i>Concepts</span>
      <ul class="section-items">
        <li><a href="../concepts/README.html">Overview</a></li>
        <li><a href="../concepts/architecture.html">Architecture</a></li>
        <li><a href="../concepts/browser-modes.html">Browser Modes</a></li>
        <li><a href="../concepts/extension-communication.html">Extension Communication</a></li>
        <li><a href="../concepts/instance-lifecycle.html">Instance Lifecycle</a></li>
        <li><a href="../concepts/mcp-protocol.html">MCP Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="wrench"></i>Tools</span>
      <ul class="section-items">
        <li><a href="../tools/README.html">Overview</a></li>
        <li><a href="../tools/browser-content.html">browser_content</a></li>
        <li><a href="../tools/browser-debug.html">browser_debug</a></li>
        <li><a href="../tools/browser-emulate.html">browser_emulate</a></li>
        <li><a href="../tools/browser-execute.html">browser_execute</a></li>
        <li><a href="../tools/browser-instance.html">browser_instance</a></li>
        <li><a href="../tools/browser-interact.html">browser_interact</a></li>
        <li><a href="../tools/browser-navigate.html">browser_navigate</a></li>
        <li><a href="../tools/browser-network.html">browser_network</a></li>
        <li><a href="../tools/browser-tab.html">browser_tab</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="settings"></i>Configuration</span>
      <ul class="section-items">
        <li><a href="../configuration/README.html">Overview</a></li>
        <li><a href="../configuration/authentication.html">Authentication</a></li>
        <li><a href="../configuration/environment-variables.html">Environment Variables</a></li>
        <li><a href="../configuration/local-mode.html">Local Mode</a></li>
        <li><a href="../configuration/remote-mode.html">Remote Mode</a></li>
        <li><a href="../configuration/security-hardening.html">Security Hardening</a></li>
        <li><a href="../configuration/tls-setup.html">TLS Setup</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="book-open"></i>Guides</span>
      <ul class="section-items">
        <li><a href="../guides/README.html">Overview</a></li>
        <li><a href="../guides/debugging-tips.html">Debugging Tips Guide</a></li>
        <li><a href="../guides/file-downloads.html">File Downloads Guide</a></li>
        <li><a href="../guides/form-filling.html">Form Filling Guide</a></li>
        <li><a href="../guides/handling-popups.html">Handling Popups Guide</a></li>
        <li><a href="../guides/network-interception.html">Network Interception Guide</a></li>
        <li><a href="../guides/testing-workflows.html">Testing Workflows Guide</a></li>
        <li><a href="../guides/web-scraping.html">Web Scraping Guide</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="plug"></i>Integration</span>
      <ul class="section-items">
        <li><a href="../integration/README.html">Overview</a></li>
        <li><a href="../integration/ci-cd.html">CI/CD Integration</a></li>
        <li><a href="../integration/claude-code.html">Claude Code Integration</a></li>
        <li><a href="../integration/claude-desktop.html">Claude Desktop Integration</a></li>
        <li><a href="../integration/cursor.html">Cursor Integration</a></li>
        <li><a href="../integration/custom-clients.html">Custom Client Integration</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="code"></i>Api Reference</span>
      <ul class="section-items">
        <li><a href="../api-reference/README.html">Overview</a></li>
        <li><a href="../api-reference/error-codes.html">Error Codes</a></li>
        <li><a href="../api-reference/http-endpoints.html">HTTP Endpoints</a></li>
        <li><a href="../api-reference/sse-protocol.html">SSE Protocol</a></li>
        <li><a href="../api-reference/websocket-protocol.html">WebSocket Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section open">
      <span class="section-title"><i data-lucide="list-checks"></i>Tasks</span>
      <ul class="section-items">
        <li><a href="../tasks/README.html">Overview</a></li>
        <li><a href="../tasks/architecture.html">Architecture Overview</a></li>
        <li><a href="../tasks/configuration.html">Configuration</a></li>
        <li><a href="../tasks/contributing.html">Contributing</a></li>
        <li><a href="../tasks/error-handling.html">Error Handling</a></li>
        <li><a href="../tasks/examples.html">Examples</a></li>
        <li><a href="../tasks/getting-started.html">Getting Started</a></li>
        <li><a href="../tasks/internals.html">Internals</a></li>
        <li><a href="../tasks/rest-api.html">REST API Reference</a></li>
        <li><a href="../tasks/task-format.html">Task Format</a></li>
        <li><a href="../tasks/websocket-api.html" class="active">WebSocket API Reference</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="terminal"></i>Development</span>
      <ul class="section-items">
        <li><a href="../development/README.html">Overview</a></li>
        <li><a href="../development/adding-tools.html">Adding Tools</a></li>
        <li><a href="../development/debugging.html">Debugging</a></li>
        <li><a href="../development/extension-development.html">Extension Development</a></li>
        <li><a href="../development/internals.html">Internals</a></li>
        <li><a href="../development/local-setup.html">Local Development Setup</a></li>
        <li><a href="../development/project-structure.html">Project Structure</a></li>
        <li><a href="../development/release-process.html">Release Process</a></li>
        <li><a href="../development/testing.html">Testing</a></li>
      </ul>
    </li>
  </ul>
  <div class="sidebar-footer">
    <div class="version">v2.0.0</div>
    <div class="generated">Generated 2026-01-26</div>
  </div>
</nav>

  <main class="content">
    <article>
      <h1>WebSocket API Reference</h1>
<p>The Task WebSocket API provides real-time task submission, progress monitoring, and management.</p>
<h2>Connection</h2>
<p><strong>Endpoint:</strong> <code>ws://localhost:3400</code></p>
<p><strong>Connection Example:</strong></p>
<pre><code class="language-javascript">const WebSocket = require(&#039;ws&#039;);
const ws = new WebSocket(&#039;ws://localhost:3400&#039;);</code></pre><p>Upon connection, the server sends a welcome message:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;welcome&quot;,
  &quot;sessionId&quot;: &quot;a1b2c3d4-e5f6-7890-abcd-ef1234567890&quot;,
  &quot;message&quot;: &quot;Connected to Moonsurf Task Server&quot;
}</code></pre><h2>Message Protocol</h2>
<p>All messages are JSON objects with a <code>type</code> field indicating the message type.</p>
<h3>Client → Server Messages</h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>task_submit</code></td><td>Submit a new task</td></tr><tr><td><code>task_list</code></td><td>List tasks</td></tr><tr><td><code>task_status</code></td><td>Get task details</td></tr><tr><td><code>task_cancel</code></td><td>Cancel a task</td></tr><tr><td><code>subscribe_task</code></td><td>Subscribe to task updates</td></tr><tr><td><code>subscribe_instance</code></td><td>Subscribe to instance updates</td></tr></tbody></table></div><h3>Server → Client Messages</h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>welcome</code></td><td>Connection established</td></tr><tr><td><code>task_submit_response</code></td><td>Response to task submission</td></tr><tr><td><code>task_progress</code></td><td>Command execution progress</td></tr><tr><td><code>task_complete</code></td><td>Task finished</td></tr><tr><td><code>task_list_response</code></td><td>Response to list request</td></tr><tr><td><code>task_status_response</code></td><td>Response to status request</td></tr><tr><td><code>task_cancel_response</code></td><td>Response to cancel request</td></tr><tr><td><code>error</code></td><td>Error occurred</td></tr></tbody></table></div><hr>
<h2>Task Submission</h2>
<h3>Request: <code>task_submit</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_submit&quot;,
  &quot;task_name&quot;: &quot;Search Google&quot;,
  &quot;task_intention&quot;: &quot;Search for browser automation tools&quot;,
  &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;,
  &quot;commands&quot;: [
    {
      &quot;tool_name&quot;: &quot;browser_navigate&quot;,
      &quot;intention&quot;: &quot;Go to Google&quot;,
      &quot;args&quot;: { &quot;action&quot;: &quot;goto&quot;, &quot;url&quot;: &quot;https://www.google.com&quot; }
    },
    {
      &quot;tool_name&quot;: &quot;browser_interact&quot;,
      &quot;intention&quot;: &quot;Type search query&quot;,
      &quot;args&quot;: { &quot;action&quot;: &quot;type&quot;, &quot;selector&quot;: &quot;textarea[name=q]&quot;, &quot;text&quot;: &quot;browser automation&quot; }
    },
    {
      &quot;tool_name&quot;: &quot;browser_interact&quot;,
      &quot;intention&quot;: &quot;Submit search&quot;,
      &quot;args&quot;: { &quot;action&quot;: &quot;keyboard&quot;, &quot;key&quot;: &quot;Enter&quot; }
    }
  ],
  &quot;metadata&quot;: {
    &quot;client&quot;: &quot;my-app&quot;,
    &quot;requestId&quot;: &quot;req-123&quot;
  }
}</code></pre><p><strong>Fields:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>type</code></td><td>string</td><td>Yes</td><td>Must be <code>&quot;task_submit&quot;</code></td></tr><tr><td><code>task_name</code></td><td>string</td><td>Yes</td><td>Human-readable task name</td></tr><tr><td><code>task_intention</code></td><td>string</td><td>Yes</td><td>Description of task goal</td></tr><tr><td><code>instanceId</code></td><td>string</td><td>No</td><td>Target browser instance. If omitted, uses first connected instance</td></tr><tr><td><code>commands</code></td><td>array</td><td>Yes</td><td>Array of commands to execute</td></tr><tr><td><code>metadata</code></td><td>object</td><td>No</td><td>Custom metadata passed through to responses</td></tr></tbody></table></div><p><strong>Command Object:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>tool_name</code></td><td>string</td><td>Yes</td><td>MCP tool name (e.g., <code>browser_navigate</code>)</td></tr><tr><td><code>intention</code></td><td>string</td><td>Yes</td><td>Description of command purpose</td></tr><tr><td><code>args</code></td><td>object</td><td>Yes</td><td>Tool-specific arguments</td></tr></tbody></table></div><h3>Response: <code>task_submit_response</code></h3>
<p><strong>Success:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_submit_response&quot;,
  &quot;success&quot;: true,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;queuePosition&quot;: 1
}</code></pre><p><strong>Error:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_submit_response&quot;,
  &quot;success&quot;: false,
  &quot;error&quot;: &quot;No connected browser instances&quot;
}</code></pre><hr>
<h2>Progress Updates</h2>
<p>After task submission, the client automatically receives progress updates.</p>
<h3><code>task_progress</code></h3>
<p>Emitted twice per command: once when starting (<code>running</code>) and once when finished (<code>success</code>/<code>error</code>).</p>
<p><strong>Running:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_progress&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;commandId&quot;: &quot;task_1234567890_1_cmd_0&quot;,
  &quot;commandIndex&quot;: 0,
  &quot;totalCommands&quot;: 3,
  &quot;status&quot;: &quot;running&quot;,
  &quot;timestamp&quot;: 1234567890123,
  &quot;tool_name&quot;: &quot;browser_navigate&quot;,
  &quot;intention&quot;: &quot;Go to Google&quot;
}</code></pre><p><strong>Success:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_progress&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;commandId&quot;: &quot;task_1234567890_1_cmd_0&quot;,
  &quot;commandIndex&quot;: 0,
  &quot;totalCommands&quot;: 3,
  &quot;status&quot;: &quot;success&quot;,
  &quot;timestamp&quot;: 1234567890456,
  &quot;tool_name&quot;: &quot;browser_navigate&quot;,
  &quot;intention&quot;: &quot;Go to Google&quot;,
  &quot;result&quot;: {
    &quot;content&quot;: [{ &quot;type&quot;: &quot;text&quot;, &quot;text&quot;: &quot;{\&quot;success\&quot;: true}&quot; }]
  }
}</code></pre><p><strong>Error:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_progress&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;commandId&quot;: &quot;task_1234567890_1_cmd_1&quot;,
  &quot;commandIndex&quot;: 1,
  &quot;totalCommands&quot;: 3,
  &quot;status&quot;: &quot;error&quot;,
  &quot;timestamp&quot;: 1234567890789,
  &quot;tool_name&quot;: &quot;browser_interact&quot;,
  &quot;intention&quot;: &quot;Click button&quot;,
  &quot;error&quot;: {
    &quot;code&quot;: &quot;EXECUTION_ERROR&quot;,
    &quot;message&quot;: &quot;Element not found: #nonexistent&quot;
  }
}</code></pre><p><strong>Fields:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>taskId</code></td><td>string</td><td>Task identifier</td></tr><tr><td><code>commandId</code></td><td>string</td><td>Command identifier</td></tr><tr><td><code>commandIndex</code></td><td>number</td><td>0-based index in commands array</td></tr><tr><td><code>totalCommands</code></td><td>number</td><td>Total number of commands</td></tr><tr><td><code>status</code></td><td>string</td><td><code>&quot;running&quot;</code>, <code>&quot;success&quot;</code>, or <code>&quot;error&quot;</code></td></tr><tr><td><code>timestamp</code></td><td>number</td><td>Unix timestamp in milliseconds</td></tr><tr><td><code>tool_name</code></td><td>string</td><td>MCP tool name</td></tr><tr><td><code>intention</code></td><td>string</td><td>Command intention</td></tr><tr><td><code>result</code></td><td>object</td><td>Present on success, contains tool result</td></tr><tr><td><code>error</code></td><td>object</td><td>Present on error, contains code and message</td></tr></tbody></table></div><h3><code>task_complete</code></h3>
<p>Emitted when task finishes (completed, failed, or cancelled).</p>
<p><strong>Completed:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_complete&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;status&quot;: &quot;completed&quot;,
  &quot;timestamp&quot;: 1234567891000,
  &quot;summary&quot;: {
    &quot;totalCommands&quot;: 3,
    &quot;successfulCommands&quot;: 3,
    &quot;duration&quot;: 1500
  },
  &quot;results&quot;: [
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_0&quot;, &quot;status&quot;: &quot;success&quot;, &quot;result&quot;: {...} },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_1&quot;, &quot;status&quot;: &quot;success&quot;, &quot;result&quot;: {...} },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_2&quot;, &quot;status&quot;: &quot;success&quot;, &quot;result&quot;: {...} }
  ]
}</code></pre><p><strong>Failed:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_complete&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;status&quot;: &quot;failed&quot;,
  &quot;timestamp&quot;: 1234567891000,
  &quot;summary&quot;: {
    &quot;totalCommands&quot;: 3,
    &quot;successfulCommands&quot;: 1,
    &quot;failedCommandIndex&quot;: 1,
    &quot;duration&quot;: 800
  },
  &quot;error&quot;: {
    &quot;code&quot;: &quot;EXECUTION_ERROR&quot;,
    &quot;message&quot;: &quot;Element not found&quot;,
    &quot;commandId&quot;: &quot;task_1234567890_1_cmd_1&quot;
  },
  &quot;results&quot;: [
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_0&quot;, &quot;status&quot;: &quot;success&quot;, &quot;result&quot;: {...} },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_1&quot;, &quot;status&quot;: &quot;error&quot;, &quot;error&quot;: {...} },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_2&quot;, &quot;status&quot;: &quot;skipped&quot; }
  ]
}</code></pre><p><strong>Cancelled:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_complete&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;status&quot;: &quot;cancelled&quot;,
  &quot;timestamp&quot;: 1234567891000,
  &quot;summary&quot;: {
    &quot;totalCommands&quot;: 3,
    &quot;successfulCommands&quot;: 1,
    &quot;duration&quot;: 500
  },
  &quot;error&quot;: {
    &quot;code&quot;: &quot;CANCELLED&quot;,
    &quot;message&quot;: &quot;Task cancelled by user&quot;
  },
  &quot;results&quot;: [
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_0&quot;, &quot;status&quot;: &quot;success&quot;, &quot;result&quot;: {...} },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_1&quot;, &quot;status&quot;: &quot;skipped&quot; },
    { &quot;commandId&quot;: &quot;task_1234567890_1_cmd_2&quot;, &quot;status&quot;: &quot;skipped&quot; }
  ]
}</code></pre><hr>
<h2>Task Listing</h2>
<h3>Request: <code>task_list</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_list&quot;,
  &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;,
  &quot;status&quot;: &quot;running&quot;
}</code></pre><p><strong>Fields:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>instanceId</code></td><td>string</td><td>No</td><td>Filter by instance</td></tr><tr><td><code>status</code></td><td>string</td><td>No</td><td>Filter by status: <code>queued</code>, <code>running</code>, <code>completed</code>, <code>failed</code>, <code>cancelled</code>, or <code>all</code></td></tr></tbody></table></div><h3>Response: <code>task_list_response</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_list_response&quot;,
  &quot;tasks&quot;: [
    {
      &quot;id&quot;: &quot;task_1234567890_1&quot;,
      &quot;name&quot;: &quot;Search Google&quot;,
      &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;,
      &quot;status&quot;: &quot;running&quot;,
      &quot;commandCount&quot;: 3,
      &quot;currentCommandIndex&quot;: 1,
      &quot;createdAt&quot;: 1234567890000
    },
    {
      &quot;id&quot;: &quot;task_1234567890_2&quot;,
      &quot;name&quot;: &quot;Take Screenshot&quot;,
      &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;,
      &quot;status&quot;: &quot;queued&quot;,
      &quot;commandCount&quot;: 2,
      &quot;currentCommandIndex&quot;: 0,
      &quot;createdAt&quot;: 1234567890100
    }
  ]
}</code></pre><hr>
<h2>Task Status</h2>
<h3>Request: <code>task_status</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_status&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;
}</code></pre><h3>Response: <code>task_status_response</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_status_response&quot;,
  &quot;task&quot;: {
    &quot;id&quot;: &quot;task_1234567890_1&quot;,
    &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;,
    &quot;name&quot;: &quot;Search Google&quot;,
    &quot;intention&quot;: &quot;Search for browser automation tools&quot;,
    &quot;status&quot;: &quot;running&quot;,
    &quot;currentCommandIndex&quot;: 1,
    &quot;createdAt&quot;: 1234567890000,
    &quot;startedAt&quot;: 1234567890100,
    &quot;commands&quot;: [
      {
        &quot;id&quot;: &quot;task_1234567890_1_cmd_0&quot;,
        &quot;tool_name&quot;: &quot;browser_navigate&quot;,
        &quot;intention&quot;: &quot;Go to Google&quot;,
        &quot;status&quot;: &quot;success&quot;,
        &quot;startedAt&quot;: 1234567890100,
        &quot;completedAt&quot;: 1234567890300
      },
      {
        &quot;id&quot;: &quot;task_1234567890_1_cmd_1&quot;,
        &quot;tool_name&quot;: &quot;browser_interact&quot;,
        &quot;intention&quot;: &quot;Type search query&quot;,
        &quot;status&quot;: &quot;running&quot;,
        &quot;startedAt&quot;: 1234567890300
      },
      {
        &quot;id&quot;: &quot;task_1234567890_1_cmd_2&quot;,
        &quot;tool_name&quot;: &quot;browser_interact&quot;,
        &quot;intention&quot;: &quot;Submit search&quot;,
        &quot;status&quot;: &quot;pending&quot;
      }
    ]
  }
}</code></pre><p><strong>Task Not Found:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_status_response&quot;,
  &quot;task&quot;: null
}</code></pre><hr>
<h2>Task Cancellation</h2>
<h3>Request: <code>task_cancel</code></h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_cancel&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;
}</code></pre><h3>Response: <code>task_cancel_response</code></h3>
<p><strong>Success:</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_cancel_response&quot;,
  &quot;success&quot;: true,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;
}</code></pre><p><strong>Failed (already completed):</strong></p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;task_cancel_response&quot;,
  &quot;success&quot;: false,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;,
  &quot;reason&quot;: &quot;Task already completed&quot;
}</code></pre><hr>
<h2>Subscriptions</h2>
<p>By default, submitting a task auto-subscribes the client to that task&#39;s updates. You can also manually subscribe.</p>
<h3>Subscribe to Task</h3>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;subscribe_task&quot;,
  &quot;taskId&quot;: &quot;task_1234567890_1&quot;
}</code></pre><h3>Subscribe to Instance</h3>
<p>Receive updates for all tasks on an instance:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;subscribe_instance&quot;,
  &quot;instanceId&quot;: &quot;inst_1234567890_abc&quot;
}</code></pre><hr>
<h2>Error Messages</h2>
<p>Generic errors are sent as:</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;error&quot;,
  &quot;error&quot;: &quot;Invalid message format&quot;,
  &quot;details&quot;: &quot;Missing required field: task_name&quot;
}</code></pre><hr>
<h2>Complete Example</h2>
<pre><code class="language-javascript">const WebSocket = require(&#039;ws&#039;);
const ws = new WebSocket(&#039;ws://localhost:3400&#039;);

ws.on(&#039;open&#039;, () =&gt; {
  console.log(&#039;Connected to Task Server&#039;);

  // Submit a task
  ws.send(JSON.stringify({
    type: &#039;task_submit&#039;,
    task_name: &#039;Google Search&#039;,
    task_intention: &#039;Search for Node.js tutorials&#039;,
    commands: [
      {
        tool_name: &#039;browser_navigate&#039;,
        intention: &#039;Open Google&#039;,
        args: { action: &#039;goto&#039;, url: &#039;https://www.google.com&#039; }
      },
      {
        tool_name: &#039;browser_interact&#039;,
        intention: &#039;Enter search term&#039;,
        args: { action: &#039;type&#039;, selector: &#039;textarea[name=q]&#039;, text: &#039;Node.js tutorials&#039; }
      },
      {
        tool_name: &#039;browser_interact&#039;,
        intention: &#039;Press Enter&#039;,
        args: { action: &#039;keyboard&#039;, key: &#039;Enter&#039; }
      }
    ]
  }));
});

ws.on(&#039;message&#039;, (data) =&gt; {
  const msg = JSON.parse(data.toString());

  switch (msg.type) {
    case &#039;welcome&#039;:
      console.log(`Session: ${msg.sessionId}`);
      break;

    case &#039;task_submit_response&#039;:
      if (msg.success) {
        console.log(`Task submitted: ${msg.taskId} (queue position: ${msg.queuePosition})`);
      } else {
        console.error(`Submission failed: ${msg.error}`);
      }
      break;

    case &#039;task_progress&#039;:
      console.log(`[${msg.commandIndex + 1}/${msg.totalCommands}] ${msg.status}: ${msg.intention}`);
      if (msg.status === &#039;error&#039;) {
        console.error(`  Error: ${msg.error.message}`);
      }
      break;

    case &#039;task_complete&#039;:
      console.log(`Task ${msg.status}!`);
      console.log(`  Duration: ${msg.summary.duration}ms`);
      console.log(`  Commands: ${msg.summary.successfulCommands}/${msg.summary.totalCommands} succeeded`);
      ws.close();
      break;
  }
});

ws.on(&#039;close&#039;, () =&gt; {
  console.log(&#039;Connection closed&#039;);
});

ws.on(&#039;error&#039;, (err) =&gt; {
  console.error(&#039;WebSocket error:&#039;, err);
});</code></pre><p><strong>Output:</strong></p>
<pre><code class="language-plaintext">Connected to Task Server
Session: a1b2c3d4-e5f6-7890-abcd-ef1234567890
Task submitted: task_1234567890_1 (queue position: 1)
[1/3] running: Open Google
[1/3] success: Open Google
[2/3] running: Enter search term
[2/3] success: Enter search term
[3/3] running: Press Enter
[3/3] success: Press Enter
Task completed!
  Duration: 2500ms
  Commands: 3/3 succeeded
Connection closed</code></pre>
    </article>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Initialize syntax highlighting
    hljs.highlightAll();

    // Toggle sections
    document.querySelectorAll('.section-title').forEach(title => {
      title.addEventListener('click', () => {
        title.parentElement.classList.toggle('open');
      });
    });
  </script>
</body>
</html>