<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>File Downloads Guide - Moonsurf Documentation</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poltawski+Nowy:wght@400;500;600;700&display=block" as="style">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=block" as="style">
  <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
  <nav class="sidebar">
  <div class="sidebar-header">
    <a href="../index.html" class="logo">Moonsurf</a>
  </div>
  <ul class="nav-list">
    <li><a href="../index.html">Moonsurf Browser Control Documentation</a></li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="rocket"></i>Getting Started</span>
      <ul class="section-items">
        <li><a href="../getting-started/README.html">Overview</a></li>
        <li><a href="../getting-started/connecting-ai-clients.html">Connecting AI Clients</a></li>
        <li><a href="../getting-started/first-automation.html">First Automation</a></li>
        <li><a href="../getting-started/installation.html">Installation</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="lightbulb"></i>Concepts</span>
      <ul class="section-items">
        <li><a href="../concepts/README.html">Overview</a></li>
        <li><a href="../concepts/architecture.html">Architecture</a></li>
        <li><a href="../concepts/browser-modes.html">Browser Modes</a></li>
        <li><a href="../concepts/extension-communication.html">Extension Communication</a></li>
        <li><a href="../concepts/instance-lifecycle.html">Instance Lifecycle</a></li>
        <li><a href="../concepts/mcp-protocol.html">MCP Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="wrench"></i>Tools</span>
      <ul class="section-items">
        <li><a href="../tools/README.html">Overview</a></li>
        <li><a href="../tools/browser-content.html">browser_content</a></li>
        <li><a href="../tools/browser-debug.html">browser_debug</a></li>
        <li><a href="../tools/browser-emulate.html">browser_emulate</a></li>
        <li><a href="../tools/browser-execute.html">browser_execute</a></li>
        <li><a href="../tools/browser-instance.html">browser_instance</a></li>
        <li><a href="../tools/browser-interact.html">browser_interact</a></li>
        <li><a href="../tools/browser-navigate.html">browser_navigate</a></li>
        <li><a href="../tools/browser-network.html">browser_network</a></li>
        <li><a href="../tools/browser-tab.html">browser_tab</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="settings"></i>Configuration</span>
      <ul class="section-items">
        <li><a href="../configuration/README.html">Overview</a></li>
        <li><a href="../configuration/authentication.html">Authentication</a></li>
        <li><a href="../configuration/environment-variables.html">Environment Variables</a></li>
        <li><a href="../configuration/local-mode.html">Local Mode</a></li>
        <li><a href="../configuration/remote-mode.html">Remote Mode</a></li>
        <li><a href="../configuration/security-hardening.html">Security Hardening</a></li>
        <li><a href="../configuration/tls-setup.html">TLS Setup</a></li>
      </ul>
    </li>
    <li class="nav-section open">
      <span class="section-title"><i data-lucide="book-open"></i>Guides</span>
      <ul class="section-items">
        <li><a href="../guides/README.html">Overview</a></li>
        <li><a href="../guides/debugging-tips.html">Debugging Tips Guide</a></li>
        <li><a href="../guides/file-downloads.html" class="active">File Downloads Guide</a></li>
        <li><a href="../guides/form-filling.html">Form Filling Guide</a></li>
        <li><a href="../guides/handling-popups.html">Handling Popups Guide</a></li>
        <li><a href="../guides/network-interception.html">Network Interception Guide</a></li>
        <li><a href="../guides/testing-workflows.html">Testing Workflows Guide</a></li>
        <li><a href="../guides/web-scraping.html">Web Scraping Guide</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="plug"></i>Integration</span>
      <ul class="section-items">
        <li><a href="../integration/README.html">Overview</a></li>
        <li><a href="../integration/ci-cd.html">CI/CD Integration</a></li>
        <li><a href="../integration/claude-code.html">Claude Code Integration</a></li>
        <li><a href="../integration/claude-desktop.html">Claude Desktop Integration</a></li>
        <li><a href="../integration/cursor.html">Cursor Integration</a></li>
        <li><a href="../integration/custom-clients.html">Custom Client Integration</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="code"></i>Api Reference</span>
      <ul class="section-items">
        <li><a href="../api-reference/README.html">Overview</a></li>
        <li><a href="../api-reference/error-codes.html">Error Codes</a></li>
        <li><a href="../api-reference/http-endpoints.html">HTTP Endpoints</a></li>
        <li><a href="../api-reference/sse-protocol.html">SSE Protocol</a></li>
        <li><a href="../api-reference/websocket-protocol.html">WebSocket Protocol</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="list-checks"></i>Tasks</span>
      <ul class="section-items">
        <li><a href="../tasks/README.html">Overview</a></li>
        <li><a href="../tasks/architecture.html">Architecture Overview</a></li>
        <li><a href="../tasks/configuration.html">Configuration</a></li>
        <li><a href="../tasks/contributing.html">Contributing</a></li>
        <li><a href="../tasks/error-handling.html">Error Handling</a></li>
        <li><a href="../tasks/examples.html">Examples</a></li>
        <li><a href="../tasks/getting-started.html">Getting Started</a></li>
        <li><a href="../tasks/internals.html">Internals</a></li>
        <li><a href="../tasks/rest-api.html">REST API Reference</a></li>
        <li><a href="../tasks/task-format.html">Task Format</a></li>
        <li><a href="../tasks/websocket-api.html">WebSocket API Reference</a></li>
      </ul>
    </li>
    <li class="nav-section">
      <span class="section-title"><i data-lucide="terminal"></i>Development</span>
      <ul class="section-items">
        <li><a href="../development/README.html">Overview</a></li>
        <li><a href="../development/adding-tools.html">Adding Tools</a></li>
        <li><a href="../development/debugging.html">Debugging</a></li>
        <li><a href="../development/extension-development.html">Extension Development</a></li>
        <li><a href="../development/internals.html">Internals</a></li>
        <li><a href="../development/local-setup.html">Local Development Setup</a></li>
        <li><a href="../development/project-structure.html">Project Structure</a></li>
        <li><a href="../development/release-process.html">Release Process</a></li>
        <li><a href="../development/testing.html">Testing</a></li>
      </ul>
    </li>
  </ul>
  <div class="sidebar-footer">
    <div class="version">v2.0.0</div>
    <div class="generated">Generated 2026-01-26</div>
  </div>
</nav>

  <main class="content">
    <article>
      <h1>File Downloads Guide</h1>
<p>Manage and track file downloads with Moonsurf&#39;s download monitoring capabilities.</p>
<h2>Overview</h2>
<p>Moonsurf tracks file downloads using a file system watcher on the browser&#39;s download directory. This allows you to:</p>
<ul>
<li>Monitor download progress</li>
<li>Get completed download paths</li>
<li>Verify download success</li>
<li>Handle different file types</li>
</ul>
<h2>Checking Downloads</h2>
<h3>List All Downloads</h3>
<pre><code class="language-plaintext">browser_navigate
  action: &quot;downloads&quot;</code></pre><p>Returns:</p>
<pre><code class="language-json">{
  &quot;downloads&quot;: [
    {
      &quot;filename&quot;: &quot;report.pdf&quot;,
      &quot;path&quot;: &quot;/Users/me/Downloads/report.pdf&quot;,
      &quot;size&quot;: 245678,
      &quot;startedAt&quot;: &quot;2024-01-15T10:30:00.000Z&quot;,
      &quot;completedAt&quot;: &quot;2024-01-15T10:30:05.000Z&quot;,
      &quot;status&quot;: &quot;completed&quot;
    }
  ]
}</code></pre><h3>Wait for Download</h3>
<pre><code class="language-plaintext">browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true
  timeout: 30000</code></pre><p>This waits up to 30 seconds for a download to complete.</p>
<h2>Triggering Downloads</h2>
<h3>Click Download Link</h3>
<pre><code class="language-plaintext"># Click a download link
browser_interact
  action: &quot;click&quot;
  selector: &quot;a[download]&quot;

# Wait for download to complete
browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true</code></pre><h3>Click Download Button</h3>
<pre><code class="language-plaintext"># Many sites use buttons that trigger downloads
browser_interact
  action: &quot;click&quot;
  selector: &quot;#export-button&quot;

browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true
  timeout: 60000</code></pre><h3>Download via Form Submission</h3>
<pre><code class="language-plaintext"># Fill export options
browser_interact action=&quot;select&quot; selector=&quot;#format&quot; value=&quot;csv&quot;
browser_interact action=&quot;check&quot; selector=&quot;#include-headers&quot;

# Submit to trigger download
browser_interact action=&quot;click&quot; selector=&quot;#download-report&quot;

# Wait for file
browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true</code></pre><h2>Download Types</h2>
<h3>PDF Documents</h3>
<pre><code class="language-plaintext"># Click PDF download link
browser_interact action=&quot;click&quot; selector=&quot;a.pdf-download&quot;

# Wait for PDF
browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true
  timeout: 30000</code></pre><h3>Excel/CSV Exports</h3>
<pre><code class="language-plaintext"># Trigger export
browser_interact action=&quot;click&quot; selector=&quot;#export-to-excel&quot;

# Wait for file
browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true</code></pre><h3>Images</h3>
<pre><code class="language-plaintext"># Right-click and download (or use direct link)
browser_interact
  action: &quot;click&quot;
  selector: &quot;a[href$=&#039;.jpg&#039;]&quot;

browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true</code></pre><h3>Large Files</h3>
<p>For large files, use longer timeouts:</p>
<pre><code class="language-plaintext">browser_interact action=&quot;click&quot; selector=&quot;#download-backup&quot;

browser_navigate
  action: &quot;downloads&quot;
  waitForDownload: true
  timeout: 300000  # 5 minutes</code></pre><h2>Verifying Downloads</h2>
<h3>Check File Exists</h3>
<pre><code class="language-plaintext"># Get download info
const downloads = browser_navigate
  action: &quot;downloads&quot;

# Verify the file
browser_execute
  action: &quot;evaluate&quot;
  script: |
    // File info is returned in the downloads response
    return true;</code></pre><h3>Verify File Size</h3>
<pre><code class="language-plaintext">browser_navigate action=&quot;downloads&quot;

# Check that file size is reasonable
# The downloads response includes size information</code></pre><h3>Check File Type</h3>
<pre><code class="language-plaintext">const downloads = browser_navigate action=&quot;downloads&quot;

# Verify filename extension matches expected type
# downloads[0].filename should end with expected extension</code></pre><h2>Multiple Downloads</h2>
<h3>Sequential Downloads</h3>
<pre><code class="language-plaintext"># Download first file
browser_interact action=&quot;click&quot; selector=&quot;#file-1&quot;
browser_navigate action=&quot;downloads&quot; waitForDownload=true

# Download second file
browser_interact action=&quot;click&quot; selector=&quot;#file-2&quot;
browser_navigate action=&quot;downloads&quot; waitForDownload=true

# Download third file
browser_interact action=&quot;click&quot; selector=&quot;#file-3&quot;
browser_navigate action=&quot;downloads&quot; waitForDownload=true</code></pre><h3>Batch Download</h3>
<pre><code class="language-plaintext"># Click &quot;Download All&quot; or similar
browser_interact action=&quot;click&quot; selector=&quot;#download-all&quot;

# May trigger multiple downloads
# Wait and check downloads list
browser_execute
  action: &quot;evaluate&quot;
  script: &quot;await new Promise(r =&gt; setTimeout(r, 10000))&quot;

browser_navigate action=&quot;downloads&quot;</code></pre><h2>Download Progress</h2>
<p>Downloads include status information:</p>
<pre><code class="language-json">{
  &quot;downloads&quot;: [
    {
      &quot;filename&quot;: &quot;large-file.zip&quot;,
      &quot;status&quot;: &quot;in_progress&quot;,
      &quot;size&quot;: null,
      &quot;startedAt&quot;: &quot;2024-01-15T10:30:00.000Z&quot;
    }
  ]
}</code></pre><p>Possible statuses:</p>
<ul>
<li><code>in_progress</code> - Download is ongoing</li>
<li><code>completed</code> - Download finished successfully</li>
<li><code>failed</code> - Download failed</li>
</ul>
<h2>Handling Download Dialogs</h2>
<h3>Automatic Downloads</h3>
<p>Most downloads proceed automatically. For sites that show a confirmation dialog:</p>
<pre><code class="language-plaintext"># Click download
browser_interact action=&quot;click&quot; selector=&quot;#download&quot;

# Handle any confirmation dialog
browser_interact action=&quot;click&quot; selector=&quot;.confirm-download&quot;

browser_navigate action=&quot;downloads&quot; waitForDownload=true</code></pre><h3>Save As Dialog</h3>
<p>Browser save dialogs are typically not needed as downloads go to the default location automatically.</p>
<h2>Download Directory</h2>
<p>By default, downloads go to the browser&#39;s default download location:</p>
<ul>
<li><strong>macOS</strong>: <code>~/Downloads</code></li>
<li><strong>Linux</strong>: <code>~/Downloads</code></li>
<li><strong>Windows</strong>: <code>%USERPROFILE%\Downloads</code></li>
</ul>
<p>The exact path is returned in the download info.</p>
<h2>Common Download Scenarios</h2>
<h3>Export Report from Web App</h3>
<pre><code class="language-plaintext"># Navigate to reports section
browser_navigate action=&quot;goto&quot; url=&quot;https://app.example.com/reports&quot;

# Configure report
browser_interact action=&quot;select&quot; selector=&quot;#date-range&quot; value=&quot;last-month&quot;
browser_interact action=&quot;select&quot; selector=&quot;#format&quot; value=&quot;pdf&quot;

# Generate report (may take time)
browser_interact action=&quot;click&quot; selector=&quot;#generate-report&quot;

# Wait for generation
browser_execute
  action: &quot;evaluate&quot;
  script: |
    await new Promise(resolve =&gt; {
      const check = () =&gt; {
        const btn = document.querySelector(&#039;#download-report:not([disabled])&#039;);
        if (btn) resolve();
        else setTimeout(check, 1000);
      };
      check();
    });

# Download the generated report
browser_interact action=&quot;click&quot; selector=&quot;#download-report&quot;

browser_navigate action=&quot;downloads&quot; waitForDownload=true timeout=60000</code></pre><h3>Download from Email/Document Service</h3>
<pre><code class="language-plaintext"># Navigate to shared file
browser_navigate
  action: &quot;goto&quot;
  url: &quot;https://drive.example.com/file/abc123&quot;

# Click download
browser_interact action=&quot;click&quot; selector=&quot;[aria-label=&#039;Download&#039;]&quot;

# Wait for file
browser_navigate action=&quot;downloads&quot; waitForDownload=true</code></pre><h3>Download Bank Statement</h3>
<pre><code class="language-plaintext"># Navigate to statements
browser_navigate action=&quot;goto&quot; url=&quot;https://bank.example.com/statements&quot;

# Select month
browser_interact action=&quot;click&quot; selector=&quot;[data-month=&#039;2024-01&#039;]&quot;

# Click download
browser_interact action=&quot;click&quot; selector=&quot;#download-statement&quot;

# Wait (bank sites can be slow)
browser_navigate action=&quot;downloads&quot; waitForDownload=true timeout=60000</code></pre><h2>Error Handling</h2>
<h3>Download Failed</h3>
<pre><code class="language-plaintext">const result = browser_navigate action=&quot;downloads&quot; waitForDownload=true

# Check status
# If result shows failed status, take screenshot and report error
if (result.downloads[0]?.status === &#039;failed&#039;) {
  browser_content action=&quot;screenshot&quot; fullPage=true
  // Report error
}</code></pre><h3>Download Timeout</h3>
<pre><code class="language-plaintext">try {
  browser_navigate action=&quot;downloads&quot; waitForDownload=true timeout=30000
} catch (error) {
  // Download didn&#039;t complete in time
  // Check current download status
  browser_navigate action=&quot;downloads&quot;

  // Screenshot for debugging
  browser_content action=&quot;screenshot&quot;
}</code></pre><h3>Network Error During Download</h3>
<p>If download fails due to network issues:</p>
<pre><code class="language-plaintext"># Retry the download
browser_interact action=&quot;click&quot; selector=&quot;#download-link&quot;
browser_navigate action=&quot;downloads&quot; waitForDownload=true</code></pre><h2>Best Practices</h2>
<h3>1. Always Wait for Downloads</h3>
<p>Don&#39;t assume downloads complete instantly:</p>
<pre><code class="language-plaintext">browser_interact action=&quot;click&quot; selector=&quot;#download&quot;
browser_navigate action=&quot;downloads&quot; waitForDownload=true</code></pre><h3>2. Use Appropriate Timeouts</h3>
<p>Small files:</p>
<pre><code class="language-plaintext">browser_navigate action=&quot;downloads&quot; waitForDownload=true timeout=10000</code></pre><p>Large files:</p>
<pre><code class="language-plaintext">browser_navigate action=&quot;downloads&quot; waitForDownload=true timeout=300000</code></pre><h3>3. Verify Download Success</h3>
<pre><code class="language-plaintext">const downloads = browser_navigate action=&quot;downloads&quot;
const latest = downloads.downloads[0]

if (latest.status !== &#039;completed&#039;) {
  // Handle failure
}</code></pre><h3>4. Handle Slow Sites</h3>
<pre><code class="language-plaintext"># Wait for download button to be ready
browser_execute
  action: &quot;evaluate&quot;
  script: |
    await new Promise(resolve =&gt; {
      const check = () =&gt; {
        const btn = document.querySelector(&#039;#download&#039;);
        if (btn &amp;&amp; !btn.disabled) resolve();
        else setTimeout(check, 500);
      };
      check();
    });

# Then click
browser_interact action=&quot;click&quot; selector=&quot;#download&quot;</code></pre><h3>5. Clean Up Downloads</h3>
<p>Be aware of accumulated downloads if running many automations.</p>
<h2>Troubleshooting</h2>
<h3>Download Doesn&#39;t Start</h3>
<ol>
<li>Check if there&#39;s a popup blocker</li>
<li>Look for confirmation dialogs</li>
<li>Verify the download link is correct</li>
<li>Check network tab for errors</li>
</ol>
<h3>Download Appears Empty</h3>
<ol>
<li>Wait longer - file may still be downloading</li>
<li>Check file size in downloads response</li>
<li>Verify the server is sending content</li>
</ol>
<h3>Wrong File Downloaded</h3>
<ol>
<li>Verify you clicked the correct element</li>
<li>Check for multiple download links</li>
<li>Look at the filename in downloads response</li>
</ol>
<h3>Download Location Unknown</h3>
<p>The downloads response includes the full path:</p>
<pre><code class="language-json">{
  &quot;downloads&quot;: [{
    &quot;path&quot;: &quot;/Users/me/Downloads/report.pdf&quot;
  }]
}</code></pre><h2>Related</h2>
<ul>
<li><a href="../tools/browser-navigate.html">browser_navigate</a> - Navigation and downloads tool</li>
<li><a href="../tools/browser-interact.html">browser_interact</a> - Clicking download links</li>
<li><a href="network-interception.html">Network Interception</a> - Monitor download requests</li>
</ul>

    </article>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Initialize syntax highlighting
    hljs.highlightAll();

    // Toggle sections
    document.querySelectorAll('.section-title').forEach(title => {
      title.addEventListener('click', () => {
        title.parentElement.classList.toggle('open');
      });
    });
  </script>
</body>
</html>